<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-3.6.0.js"></script>
</head>
<body>
<a href="index.html">CSDN</a>
<a href="personSpace.html">个人中心</a>
<tr>
    <ul>
        <li id="blogmanage">
            <a href="contentManage.html"> 文章管理</a>
        </li>
        <li id="commentmanage">
            <a id="comment" href="commentManage.html">评论管理</a>
        </li>
        <li>
            <a href="collectManage.html">收藏管理</a>
        </li>
    </ul>
</tr>
<input type="button" value="批量删除" id="deleteCollects">
<div align="center">
    <table id="show"></table>
</div>

</body>
<script>

    //个人的收藏
    function collect() {
        $.ajax({
            url: "collect/getMyCollects",
            type: "POST",
            data: {},
            success: function (res) {
                $("#show").html("")
                for (var i = 0; i < res.length; i++) {
                    $("#show").append('<input style="position:absolute; left: 600px" type="checkbox" name="subcheck" value=' + res[i].blogId + '>' + '<a style="position:absolute; right: 1000px" target=_blank href=blog.html?blogId=' + res[i].blogId + '>' + res[i].title + '</a>');
                    $("#show").append('<span style="position:absolute; right: 700px" class="deletecollect" id=' + res[i].blogId + '>' + '删除' + '</span>' + "<br>");
                }
                //删除收藏
                $(".deletecollect").click(function () {
                    $.ajax({
                        url: "collect/deleteMyCollect",
                        type: "POST",
                        data: {blogId: $(this).attr("id")},
                        complete: function (res) {
                            alert("删除成功")
                            collect()
                        }
                    })
                })
            }
        })
    }

    //批量删除收藏
    $("#deleteCollects").click(function () {
        var checkedList = new Array();
        var checkedNum = $("input[name='subcheck']:checked").length
        if (checkedNum == 0) {
            alert("请先选择删除的文章")
            return;
        }
        $("input[name='subcheck']:checked").each(function () {
            checkedList.push($(this).val())
        })
        $.ajax({
            url: "collect/deleteMyCollects",
            type: "POST",
            data: {collectIds: checkedList.toString()},
            success: function (res) {
                alert("删除成功")
                collect()
            }
        })
    })

    collect()
</script>
</html>